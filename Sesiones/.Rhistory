if(!require('MASS')){install.packages("MASS")}
library("MASS")
rmixgaussian <- function(n, k, mu, sig) {
if(!require('MASS')){install.packages("MASS")}
library("MASS")
d <- length(mu[1,])
result <- matrix(rep(NA,n*d), ncol=d)
colnames(result) <- paste0("X",1:d)
for(i in 1:n) {
result[i,] <- mvrnorm(1, mu = mu[k[i],], Sigma=sig[,,k[i]])
}
return(result)
}
